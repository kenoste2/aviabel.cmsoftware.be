<?php if (!$this->isClient): ?>
    <script>
        $(function () {
            $('#clientId').change(function () {
                $(this).parent('form').submit();
            });
        })
    </script>
<div class="aaa-theme-flex-row flex-content-row aaa-theme-overflow-hidden"> <!-- overflow hidden for iPad mini landscape view-->
            <div class="col-1">              
              <div class="aaa-theme-content-widget white-bg col-1 text-center">
			  <br>
    <form method="get">
        <select name="clientId" id="clientId">
            <?php foreach ($this->clients as $client): ?>
                <option
                    value="<?php echo $client->CLIENT_ID ?>" <?php echo $this->clientId == $client->CLIENT_ID ? 'selected="selected"' : '' ?>>
                    <?php echo $client->NAME ?>
                </option>
            <?php endforeach ?>
        </select>
    </form>
    <br>
	<br>
<?php endif; ?>
<?php if (!empty($this->aging)): ?>
    <style>
        #chartdiv {
            width: 100%;
            height: 400px;
            font-size: 11px;
            position: relative;
        }
        #chartdiv2 {
            width: 100%;
            height: 400px;
            font-size: 11px;
            position: relative;
        }
    </style>
    <style>
        #legenddiv {
            width: 100%;
            font-size: 11px;
            position: relative;
        }
        #legenddiv2 {
            width: 100%;
            font-size: 11px;
            position: relative;
        }
    </style>
    <script type="text/javascript" src="<?php echo $this->location() ?>/public/amcharts/amcharts.js"></script>
    <script type="text/javascript" src="<?php echo $this->location() ?>/public/amcharts/pie.js"></script>

 <div class="table-responsive">
					<table class="table table-striped table-bordered">
					<thead>
					
                <thead>
                <tr>
                    <td><?php echo $this->T('type_c') ?></td>
                    <td><?php echo $this->T('not_due_c') ?></td>
                    <td>< 1 M</td>
                    <td>< 3 M</td>
                    <td>< 6 M</td>
                    <td>< 12 M</td>
                    <td>< 24 M</td>
                    <td>> 24 M</td>
                    <td><?php echo $this->T('Total_c') ?></td>
                </tr>
                </thead>
                <tbody>
                <?php foreach ($this->aging as $type => $row): ?>
                    <tr>
                        <td><?php echo $type ?></td>
                        <td align="right"><?php echo $this->amount($row['0']->SUM); ?></td>
                        <td align="right"><?php echo $this->amount($row['1-30']->SUM); ?></td>
                        <td align="right"><?php echo $this->amount($row['31-90']->SUM); ?></td>
                        <td align="right"><?php echo $this->amount($row['91-180']->SUM); ?></td>
                        <td align="right"><?php echo $this->amount($row['181-365']->SUM); ?></td>
                        <td align="right"><?php echo $this->amount($row['366-730']->SUM); ?></td>
                        <td align="right"><?php echo $this->amount($row['731+']->SUM); ?></td>
                        <td align="right"	><?php echo $this->amount($row['0']->SUM + $row['1-30']->SUM + $row['31-90']->SUM + $row['91-180']->SUM + $row['181-365']->SUM + $row['366-730']->SUM + $row['731+']->SUM); ?></td>
                    </tr>
                    <?php
                    $total['0'] += $row['0']->SUM;
                    $total['1-30'] += $row['1-30']->SUM;
                    $total['31-90'] += $row['31-90']->SUM;
                    $total['91-180'] += $row['91-180']->SUM;
                    $total['181-365'] += $row['181-365']->SUM;
                    $total['366-730'] += $row['366-730']->SUM;
                    $total['731+'] += $row['731+']->SUM;
                    ?>
                <?php endforeach; ?>
                <tfoot>
                <tr>
                    <td><?php echo $this->T('Total_c') ?></td>
                    <td align="right"><?php echo $this->amount($total['0']); ?></td>
                    <td align="right"><?php echo $this->amount($total['1-30']); ?></td>
                    <td align="right"><?php echo $this->amount($total['31-90']); ?></td>
                    <td align="right"><?php echo $this->amount($total['91-180']); ?></td>
                    <td align="right"><?php echo $this->amount($total['181-365']); ?></td>
                    <td align="right"><?php echo $this->amount($total['366-730']); ?></td>
                    <td align="right"><?php echo $this->amount($total['731+']); ?></td>
                    <td align="right"><?php echo $this->amount( ($total['0'] + $total['1-30'] + $total['31-90'] + $total['91-180'] + $total['181-365'] + $total['181-365'] + $total['366-730'] + $total['731+'])); ?></td>
                </tr>
                </tfoot>
                </tbody>
            </table>
			
	                </div>                          
              </div>
            </div>  
          </div> 
		  
		       <div class="aaa-theme-flex-row flex-content-row">
            <div class="col-1">
              <div class="panel panel-default aaa-theme-content-widget white-bg no-padding aaa-theme-overflow-hidden">	  
  
                <script>
                    var chart = AmCharts.makeChart("chartdiv2", {
                        "type": "pie",
                        "theme": "none",
                        "dataProvider": [
                            <?php foreach ($total as $type => $value): ?>
                            {
                                "titel": "<?php echo $type ?> <?php $this->T("days_c")?>",
                                "waarde": <?php echo $value ?>
                            },
                            <?php endforeach ?>
                        ],
                        "valueField": "waarde",
                        "titleField": "titel",
                    });
                    var legend = new AmCharts.AmLegend();
                </script>

                <div id="chartdiv2"></div>
              </div>
            </div>  
          </div> 
   
<?php else: ?>
    <?php echo $this->Message($this->G("no_results_c")); ?>
<?php endif; ?>